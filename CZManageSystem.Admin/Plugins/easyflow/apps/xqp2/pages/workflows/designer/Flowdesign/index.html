<!DOCTYPE HTML>
<html>
<head>
    <title>WEB流程设计器 = jQuery + jsPlumb + Bootstrap</title>
   
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="leipi.org">
    <link href="Public/css/bootstrap/css/bootstrap.css?2025" rel="stylesheet" type="text/css" />
    <!--[if lte IE 6]>
    <link rel="stylesheet" type="text/css" href="Public/css/bootstrap/css/bootstrap-ie6.css?2025">
    <![endif]-->
    <!--[if lte IE 7]>
    <link rel="stylesheet" type="text/css" href="Public/css/bootstrap/css/ie.css?2025">
    <![endif]-->
    <!--<link href="Public/css/site.css?2025" rel="stylesheet" type="text/css" />
    <script type="text/javascript">
        var _root = 'http://flowdesign.leipi.org/index.php?s=/', _controller = 'flowdesign';
    </script>-->
    <link rel="stylesheet" type="text/css" href="Public/js/flowdesign/flowdesign.css" />
    <!--select 2-->
    <link rel="stylesheet" type="text/css" href="Public/js/jquery.multiselect2side/css/jquery.multiselect2side.css" />
</head>
<body>
    <!-- fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container">
                <div class="pull-right">
                     <button class="btn btn-success" type="button" id="Button1">
                        流程设置</button>
                    <button class="btn btn-info" type="button" id="leipi_save">
                        保存设计</button>
                    <button class="btn btn-danger" type="button" id="leipi_clear">
                        清空连接</button>
                </div>
                <div class="nav-collapse collapse">
                <ul class="nav">
            <li><a href="javascript:void(0);">正在设计【请假申请流程】</a></li>
        </ul>
      </div>
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div id="alertModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                ×</button>
            <h3>
                消息提示</h3>
        </div>
        <div class="modal-body">
            <p>
                提示内容</p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">
                我知道了</button>
        </div>
    </div>
    <!-- attributeModal -->
    <div id="attributeModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true" style="width: 800px; margin-left: -350px">
        <div class="modal-body" style="max-height: 500px;">
            <ul class="nav nav-tabs" id="attributeTab">
                <li class="active"><a href="#attrBasic">常规</a></li>
                <li><a href="#attrPower">权限</a></li>
                <li><a href="#attrOperate">操作</a></li>
                <!--id="tab_attrJudge"--><li><a href="#attrJudge">转出条件</a></li>
                <li><a href="#attrStyle">样式</a></li>
            </ul>
            <form class="form-horizontal" target="hiddeniframe" method="post" id="flow_attribute"
            name="flow_attribute" action="">
            <input type="hidden" name="flow_id" value="86">
            <input type="hidden" name="process_id" value="294">
            <div class="tab-content">
                <div class="tab-pane active" id="attrBasic">
                    <div class="control-group">
                          <span class="help-block">说明： 
输入用户时，只输入用户名(字符、数字以及下划线的组合)，各用户名以逗号隔开(",")； 
</span>
                    </div>
                    <hr>
                    <div class="control-group">
                        <label class="control-label" for="process_name">
                            步骤名称</label>
                        <div class="controls">
                            <input type="text" id="process_name" placeholder="步骤名称" name="process_name" value="新建步骤">
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            打印设置</label>
                        <div class="controls">
                            <label class="radio inline">
                                <input type="radio" name="process_type" value="is_step">开启
                            </label>
                            <label class="radio inline">
                                <input type="radio" name="process_type" value="is_child">关闭
                            </label>
                            <label class="radio inline">
                                - 默认开启打印。
                            </label>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="process_name">
                            打印次数</label>
                        <div class="controls">
                            <input type="text" id="Text1" placeholder="打印次数" name="process_name" value="-1">
                            <span class="help-block">- 打印设置选 开启 时此设置才生效，-1表示无限制打印次数。</span>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            允许编辑处理意见</label>
                        <div class="controls">
                            <label class="checkbox inline">
                                <input type="checkbox" name="process_type" value="is_step">允许编辑
                                <span class="help-block">- 选中则在处理工单的时候允许编辑处理意见。</span>
                            </label>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            允许退回再提交</label>
                        <div class="controls">
                            <label class="checkbox inline">
                                <input type="checkbox" name="process_type" value="is_step">允许
                                <span class="help-block">- 选中则在此步骤退还时可以直接提交到此步骤。</span>
                            </label>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            允许手机审批</label>
                        <div class="controls">
                            <label class="checkbox inline">
                                <input type="checkbox" name="process_type" value="is_step">允许
                                <span class="help-block">- 勾选后允许该步骤在手机版的页面上审批。</span>
                            </label>
                        </div>
                    </div>
                    <!--<div id="current_flow">
                        <div class="offset1">
                            <select multiple="multiple" size="7" name="process_to[]" id="process_multiple" style="display: none;">
                                <option value="295">新建步骤</option>
                            </select>
                            
                        </div>
                    </div>-->
                    <!-- current_flow end -->
                    <div id="child_flow" class="hide">
                        <div class="control-group">
                            <label class="control-label">
                                子流程</label>
                            <div class="controls">
                                <select name="child_id">
                                    <option value="0">--请选择--</option>
                                    <option value="1">123</option>
                                    <option value="2">报表</option>
                                    <option value="3">as</option>
                                    <option value="4">是的</option>
                                    <option value="5">1111</option>
                                    <option value="6">xxxx</option>
                                    <option value="7">请假</option>
                                    <option value="8">阿萨德</option>
                                    <option value="9">grg</option>
                                    <option value="10">爱爱爱</option>
                                    <option value="11">12312</option>
                                    <option value="12">gggg</option>
                                    <option value="13">1</option>
                                    <option value="14">234</option>
                                    <option value="15">test</option>
                                    <option value="16">333</option>
                                    <option value="17">xx</option>
                                    <option value="18">testss</option>
                                    <option value="19">111</option>
                                    <option value="20">www</option>
                                    <option value="21">121</option>
                                    <option value="22">546456</option>
                                    <option value="23">11</option>
                                    <option value="24">111</option>
                                    <option value="25">流程</option>
                                    <option value="26">a'f</option>
                                    <option value="27">test</option>
                                    <option value="28">请教</option>
                                    <option value="29">test</option>
                                    <option value="30">测试一下，行吧</option>
                                    <option value="31">ww</option>
                                    <option value="32">我的测试</option>
                                    <option value="33">测试</option>
                                    <option value="34">fgfg</option>
                                    <option value="35">dfasdf</option>
                                    <option value="36">ddd</option>
                                    <option value="37">312</option>
                                    <option value="38">12441</option>
                                    <option value="39">test</option>
                                    <option value="40">ahhh</option>
                                    <option value="41">11</option>
                                    <option value="42">地方</option>
                                    <option value="43">test</option>
                                    <option value="44">公司流程</option>
                                    <option value="45">对对对</option>
                                    <option value="46">xxxx</option>
                                    <option value="47">dasda</option>
                                    <option value="48">hgj</option>
                                    <option value="49">yyyyyyy</option>
                                    <option value="50">1</option>
                                    <option value="51">发送到</option>
                                    <option value="52">阿斯蒂芬</option>
                                    <option value="53">wddd</option>
                                    <option value="54">5</option>
                                    <option value="55">765</option>
                                    <option value="56">合同审批</option>
                                    <option value="57">123123</option>
                                    <option value="58">111</option>
                                    <option value="59">测试流程1</option>
                                    <option value="60">测试请假</option>
                                    <option value="61">1212</option>
                                    <option value="62">试试</option>
                                    <option value="63">请假流程</option>
                                    <option value="64">1111</option>
                                    <option value="65">1</option>
                                    <option value="66">qw</option>
                                    <option value="67">测试流程</option>
                                    <option value="68">55</option>
                                    <option value="69">errrrrrrrrrw</option>
                                    <option value="70">test by oiut</option>
                                    <option value="71">45654</option>
                                    <option value="72">xx流程</option>
                                    <option value="73">aaa</option>
                                    <option value="74">1212</option>
                                    <option value="75">test111</option>
                                    <option value="76">测试license</option>
                                    <option value="77">test</option>
                                    <option value="78">111</option>
                                    <option value="79">34444444444</option>
                                    <option value="80">测试流程1</option>
                                    <option value="81">test0001</option>
                                    <option value="82">年假流程</option>
                                    <option value="83">请假单测试</option>
                                    <option value="84">撒旦</option>
                                    <option value="85">流程以</option>
                                    <option value="86">轻轻巧巧、</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label">
                                子流程结束后动作</label>
                            <div class="controls">
                                <label class="radio inline">
                                    <input type="radio" name="child_after" value="1" checked="checked">
                                    同时结束父流程
                                </label>
                                <label class="radio inline">
                                    <input type="radio" name="child_after" value="2">
                                    返回父流程步骤
                                </label>
                            </div>
                        </div>
                        <div class="control-group hide" id="child_back_id">
                            <label class="control-label">
                                返回步骤</label>
                            <div class="controls">
                                <select name="child_back_process">
                                    <option value="0">--默认--</option>
                                    <option value="294">新建步骤</option>
                                    <option value="295">新建步骤</option>
                                    <!--option value="1">步骤1</option>
                <option value="2">步骤2</option>
                <option value="3">步骤3</option-->
                                </select>
                                <span class="help-inline">默认为当前步骤下一步</span>
                            </div>
                        </div>
                    </div>
                    <!-- child_flow end -->
                </div>
                <!-- attrBasic end -->
                <div class="tab-pane" id="attrPower">
                    <div class="control-group">
                        <label class="control-label">
                            自动选人</label>
                        <div class="controls">
                            <select name="auto_person" id="auto_person_id">
                                <option value="0">不自动选人</option>
                                <option value="1">发起人</option>
                                <option value="2">发起人的部门主管</option>
                                <option value="3">处理人的部门主管</option>
                                <option value="5">指定角色</option>
                                <option value="4">指定人员</option>
                            </select>
                            <span class="help-inline">预先设置自动选人，更方便转交工作</span>
                        </div>
                        <div class="controls hide" id="auto_unlock_id">
                            <label class="checkbox">
                                <input type="checkbox" name="auto_unlock" value="1" checked="checked">允许更改
                            </label>
                        </div>
                        <div id="auto_person_4" class="hide">
                            <div class="control-group">
                                <label class="control-label">
                                    指定主办人</label>
                                <div class="controls">
                                    <input type="hidden" name="auto_sponsor_ids" id="auto_sponsor_ids" value="">
                                    <input class="input-xlarge" readonly="readonly" type="text" placeholder="指定主办人" name="auto_sponsor_text"
                                        id="auto_user_text" value="">
                                    <a href="javascript:void(0);" class="btn" onclick="superDialog('/demo/super_dialog/op/user.html','auto_user_text','auto_sponsor_ids');">
                                        选择</a>
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label">
                                    指定经办人</label>
                                <div class="controls">
                                    <input type="hidden" name="auto_respon_ids" id="auto_respon_ids" value="">
                                    <input class="input-xlarge" readonly="readonly" type="text" placeholder="指定经办人" name="auto_respon_text"
                                        id="auto_userop_text" value="">
                                    <a href="javascript:void(0);" class="btn" onclick="superDialog('/demo/super_dialog/op/user.html','auto_userop_text','auto_respon_ids');">
                                        选择</a>
                                </div>
                            </div>
                        </div>
                        <div id="auto_person_5" class="hide">
                            <div class="control-group">
                                <label class="control-label">
                                    指定角色</label>
                                <div class="controls">
                                    <input type="hidden" name="auto_role_ids" id="auto_role_value" value="">
                                    <input class="input-xlarge" readonly="readonly" type="text" placeholder="指定角色" name="auto_role_text"
                                        id="auto_role_text" value="">
                                    <a href="javascript:void(0);" class="btn" onclick="superDialog('/demo/super_dialog/op/role.html','auto_role_text','auto_role_value');">
                                        选择</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <h4>
                        授权范围</h4>
                    <div class="control-group">
                        <label class="control-label">
                            授权人员</label>
                        <div class="controls">
                            <input type="hidden" name="range_user_ids" id="range_user_ids" value="">
                            <input class="input-xlarge" readonly="readonly" type="text" placeholder="选择人员" name="range_user_text"
                                id="range_user_text" value="">
                            <a href="javascript:void(0);" class="btn" onclick="superDialog('/demo/super_dialog/op/user.html','range_user_text','range_user_ids');">
                                选择</a>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            授权部门</label>
                        <div class="controls">
                            <input type="hidden" name="range_dept_ids" id="range_dept_ids" value="">
                            <input class="input-xlarge" readonly="readonly" type="text" placeholder="选择部门" name="range_dept_text"
                                id="range_dept_text" value="">
                            <a href="javascript:void(0);" class="btn" onclick="superDialog('/demo/super_dialog/op/dept.html','range_dept_text','range_dept_ids');">
                                选择</a>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            授权角色</label>
                        <div class="controls">
                            <input type="hidden" name="range_role_ids" id="range_role_ids" value="">
                            <input class="input-xlarge" readonly="readonly" type="text" placeholder="选择角色" name="range_role_text"
                                id="range_role_text" value="">
                            <a href="javascript:void(0);" class="btn" onclick="superDialog('/demo/super_dialog/op/role.html','range_role_text','range_role_ids');">
                                选择</a>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="controls">
                            <span class="help-block">当需要手动选人时，则授权范围生效</span>
                        </div>
                    </div>
                </div>
                <!-- attrPower end -->
                <div class="tab-pane" id="attrOperate">
                    <div class="control-group">
                        <label class="control-label">
                            交接方式</label>
                        <div class="controls">
                            <select name="receive_type">
                                <option value="0" selected="selected">明确指定主办人</option>
                                <option value="1">先接收为主办人</option>
                            </select>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="controls">
                            <label class="checkbox">
                                <input type="checkbox" name="is_user_end" value="1">允许主办人办结流程(最后步骤默认允许)
                            </label>
                            <label class="checkbox">
                                <input type="checkbox" name="is_userop_pass" value="1">经办人可以转交下一步
                            </label>
                        </div>
                    </div>
                    <hr>
                    <div class="control-group">
                        <label class="control-label">
                            会签方式</label>
                        <div class="controls">
                            <select name="is_sing">
                                <option value="1" selected="selected">允许会签</option>
                                <option value="2">禁止会签</option>
                                <option value="3">强制会签</option>
                            </select>
                            <span class="help-inline">如果设置强制会签，则本步骤全部人都会签后才能转交或办结</span>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            可见性</label>
                        <div class="controls">
                            <select name="sign_look">
                                <option value="1" selected="selected">总是可见</option>
                                <option value="2">本步骤之间经办人不可见</option>
                                <option value="3">其它步骤不可见</option>
                            </select>
                        </div>
                    </div>
                    <hr>
                    <div class="control-group">
                        <label class="control-label">
                            回退方式</label>
                        <div class="controls">
                            <select name="is_back">
                                <option value="1" selected="selected">不允许</option>
                                <option value="2">允许回退上一步</option>
                                <option value="3">允许回退之前步骤</option>
                            </select>
                        </div>
                    </div>
                </div>
                <!-- attrOperate end -->
                <div class="tab-pane" id="attrJudge">

       
    <table class="table">
      <thead>
        <tr>
          <th style="width:100px;">转出步骤</th>
          <th>转出条件设置</th>
        </tr>
      </thead>
      <tbody>

<!--模板-->
<tr id="tpl" class="hide">    
<td style="width: 100px;">@text</td>
<td>
    <table class="table table-condensed">
    <tbody>
      <tr>
        <td>
            <select id="field_@a" class="input-medium">
              <option value="">选择字段</option>
              <!-- 表单字段 start -->
              <option value="checkboxs_0">是</option>
                              <!-- 表单字段 end -->  
            </select>
            <select id="condition_@a" class="input-small">
        <option value="=">等于</option>
        <option value="<>">不等于</option>
        <option value=">">大于</option>
        <option value="<">小于</option>
        <option value=">=">大于等于</option>
        <option value="<=">小于等于</option>
        <option value="include">包含</option>
        <option value="exclude">不包含</option>
            </select>
            <input type="text" id="item_value_@a" class="input-small">
            <select id="relation_@a" class="input-small">
        <option value="AND">与</option>
        <option value="OR">或者</option>
            </select>
        </td>
        <td>
            <div class="btn-group">
        <button type="button" class="btn btn-small" onclick="fnAddLeftParenthesis('@a')">（</button>
        <button type="button" class="btn btn-small" onclick="fnAddRightParenthesis('@a')">）</button>
        <button type="button" onclick="fnAddConditions('@a')" class="btn btn-small">新增</button>
            </div>
        </td>
       </tr>
       <tr>
        <td>
            <select id="conList_@a" multiple="" style="width: 100%;height: 80px;"></select>
        </td>
        <td>
            <div class="btn-group">
        <button type="button" onclick="fnDelCon('@a')" class="btn btn-small">删行</button>
        <button type="button" onclick="fnClearCon('@a')" class="btn btn-small">清空</button>
            </div>
        </td>
      </tr>
      <tr>
        <td>
            <input id="process_in_desc_@a" type="text" name="process_in_desc_@a" style="width:98%;">
            <input name="process_in_set_@a" id="process_in_set_@a" type="hidden">
        </td>
        <td>
            <span class="xc1">不符合条件时的提示</span>
        </td>
      </tr>
    </tbody>
    </table>
</td>
</tr>


  </tbody>
  <tbody id="ctbody"><tr>    
<td style="width: 100px;"><span class="badge badge-inverse">298</span><br>新建步骤</td>
<td>
    <table class="table table-condensed">
    <tbody>
      <tr>
        <td>
            <select id="field_298" class="input-medium">
              <option value="">选择字段</option>
              <!-- 表单字段 start -->
              <option value="checkboxs_0">是</option>
                              <!-- 表单字段 end -->  
            </select>
            <select id="condition_298" class="input-small">
        <option value="=">等于</option>
        <option value="<>">不等于</option>
        <option value=">">大于</option>
        <option value="<">小于</option>
        <option value=">=">大于等于</option>
        <option value="<=">小于等于</option>
        <option value="include">包含</option>
        <option value="exclude">不包含</option>
            </select>
            <input type="text" id="item_value_298" class="input-small">
            <select id="relation_298" class="input-small">
        <option value="AND">与</option>
        <option value="OR">或者</option>
            </select>
        </td>
        <td>
            <div class="btn-group">
        <button type="button" class="btn btn-small" onclick="fnAddLeftParenthesis('298')">（</button>
        <button type="button" class="btn btn-small" onclick="fnAddRightParenthesis('298')">）</button>
        <button type="button" onclick="fnAddConditions('298')" class="btn btn-small">新增</button>
            </div>
        </td>
       </tr>
       <tr>
        <td>
            <select id="conList_298" multiple="" style="width: 100%;height: 80px;"></select>
        </td>
        <td>
            <div class="btn-group">
        <button type="button" onclick="fnDelCon('298')" class="btn btn-small">删行</button>
        <button type="button" onclick="fnClearCon('298')" class="btn btn-small">清空</button>
            </div>
        </td>
      </tr>
      <tr>
        <td>
            <input id="process_in_desc_298" type="text" name="process_in_desc_298" style="width:98%;">
            <input name="process_in_set_298" id="process_in_set_298" type="hidden">
        </td>
        <td>
            <span class="xc1">不符合条件时的提示</span>
        </td>
      </tr>
    </tbody>
    </table>
</td>
</tr><tr></tr></tbody>
</table>
<input type="hidden" name="process_condition" id="process_condition" value="298,">






    </div>
                <!-- attrJudge end -->
                <div class="tab-pane  " id="attrStyle">
                    <div class="control-group">
                        <label class="control-label" for="process_name">
                            尺寸</label>
                        <div class="controls">
                            <input type="text" class="input-small" name="style_width" id="style_width" placeholder="宽度PX"
                                value="120">
                            X
                            <input type="text" class="input-small" name="style_height" id="style_height" placeholder="高度PX"
                                value="30">
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="process_name">
                            字体颜色</label>
                        <div class="controls">
                            <input type="text" class="input-small" name="style_color" id="style_color" placeholder="#000000"
                                value="#0e76a8">
                            <div class="colors" org-bind="style_color">
                                <ul>
                                    <li class="Black active" org-data="#000" title="Black">1</li>
                                    <li class="red" org-data="#d54e21" title="Red">2</li>
                                    <li class="green" org-data="#78a300" title="Green">3</li>
                                    <li class="blue" org-data="#0e76a8" title="Blue">4</li>
                                    <li class="aero" org-data="#9cc2cb" title="Aero">5</li>
                                    <li class="grey" org-data="#73716e" title="Grey">6</li>
                                    <li class="orange" org-data="#f70" title="Orange">7</li>
                                    <li class="yellow" org-data="#fc0" title="Yellow">8</li>
                                    <li class="pink" org-data="#ff66b5" title="Pink">9</li>
                                    <li class="purple" org-data="#6a5a8c" title="Purple">10</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="process_name">
                            <span class="process-flag badge badge-inverse"><i class="icon-star-empty icon-white"
                                id="style_icon_preview"></i></span>图标</label>
                        <div class="controls">
                            <input type="text" class="input-medium" name="style_icon" id="style_icon" placeholder="icon"
                                value="icon-star">
                            <div class="colors" org-bind="style_icon">
                                <ul>
                                    <li class="Black active" org-data="icon-star-empty" title="Black"><i class="icon-star-empty icon-white">
                                    </i></li>
                                    <li class="red" org-data="icon-ok" title="Red"><i class="icon-ok icon-white"></i>
                                    </li>
                                    <li class="green" org-data="icon-remove" title="Green"><i class="icon-remove icon-white">
                                    </i></li>
                                    <li class="blue" org-data="icon-refresh" title="Blue"><i class="icon-refresh icon-white">
                                    </i></li>
                                    <li class="aero" org-data="icon-plane" title="Aero"><i class="icon-plane icon-white">
                                    </i></li>
                                    <li class="grey" org-data="icon-play" title="Grey"><i class="icon-play icon-white"></i>
                                    </li>
                                    <li class="orange" org-data="icon-heart" title="Orange"><i class="icon-heart icon-white">
                                    </i></li>
                                    <li class="yellow" org-data="icon-random" title="Yellow"><i class="icon-random icon-white">
                                    </i></li>
                                    <li class="pink" org-data="icon-home" title="Pink"><i class="icon-home icon-white"></i>
                                    </li>
                                    <li class="purple" org-data="icon-lock" title="Purple"><i class="icon-lock icon-white">
                                    </i></li>
                                </ul>
                                <a href="http://v2.bootcss.com/base-css.html#icons" target="_blank">更多</a>
                            </div>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                        </label>
                        <div class="controls">
                            <span class="help-inline">想要更多设置，可以自行添加，或反馈给我们 [ 雷劈网 ]。</span>
                        </div>
                    </div>
                    <!-- 不太完善，隐藏
         <div class="control-group">
          <label class="control-label">CSS3 图形</label>
          <div class="controls">
            <select name="style_graph" id="style_graph">
              <option value="">矩形</option>
              <option value="circle">圆形</option>
              <option value="oval">椭圆</option>
              <option value="hexagon">菱形</option>
            </select>
            <span class="help-inline">CSS3仅支持部分浏览器</span>
          </div>
        </div> -->
                </div>
                <!-- attrStyle end -->
            </div>
            <div>
                <hr>
                <span class="pull-right"><a href="#" class="btn" data-dismiss="modal" aria-hidden="true">
                    取消</a>
                    <button class="btn btn-primary" type="submit" id="attributeOK">
                        确定保存</button>
                </span>
            </div>
            </form>
            <iframe id="hiddeniframe" style="display: none;" name="hiddeniframe"></iframe>
        </div>
        <div class="modal-footer" style="padding: 5px;">
            <a href="http://www.leipi.org" target="_blank">
                <img src="http://www.leipi.org/wp-content/themes/leipi/images/leipi.png" alt="雷劈认证 icon"
                    style="width: 40px"></a>
            <!--a href="#" class="btn btn-danger" data-dismiss="modal" aria-hidden="true"><i class="icon-remove icon-white"></i></a-->
        </div>
    </div>
    <!--contextmenu div-->
    <div id="processMenu" style="display: none;">
        <ul>
            <!--li id="pm_begin"><i class="icon-play"></i>&nbsp;<span class="_label">设为第一步</span></li-->
            <!--li id="pm_addson"><i class="icon-plus"></i>&nbsp;<span class="_label">添加子步骤</span></li-->
            <!--li id="pm_copy"><i class="icon-check"></i>&nbsp;<span class="_label">复制</span></li-->
            <li id="pmAttribute"><i class="icon-cog"></i>&nbsp;<span class="_label">属性</span></li>
            <li id="pmForm"><i class="icon-th"></i>&nbsp;<span class="_label">表单字段</span></li>
            <li id="pmJudge"><i class="icon-share-alt"></i>&nbsp;<span class="_label">转出条件</span></li>
            <li id="pmSetting"><i class=" icon-wrench"></i>&nbsp;<span class="_label">样式</span></li>
            <li id="pmDelete"><i class="icon-trash"></i>&nbsp;<span class="_label">删除</span></li>
        </ul>
    </div>
    <div id="canvasMenu" style="display: none;">
        <ul>
            <li id="cmSave"><i class="icon-ok"></i>&nbsp;<span class="_label">保存设计</span></li>
            <li id="cmAdd"><i class="icon-plus"></i>&nbsp;<span class="_label">添加步骤</span></li>
            <li id="cmRefresh"><i class="icon-refresh"></i>&nbsp;<span class="_label">刷新 F5</span></li>
            <!--li id="cmPaste"><i class="icon-share"></i>&nbsp;<span class="_label">粘贴</span></li-->
            <li id="cmHelp"><i class="icon-search"></i>&nbsp;<span class="_label">帮助</span></li>
        </ul>
    </div>
    <!--end div-->
    <div class="container mini-layout" id="flowdesign_canvas">
        <!--div class="process-step btn" style="left: 189px; top: 340px;"><span class="process-num badge badge-inverse"><i class="icon-star icon-white"></i>3</span> 步骤3</div-->
    </div>
    <!-- /container -->
    <script type="text/javascript" src="Public/js/jquery-1.7.2.min.js?2025"></script>
    <script type="text/javascript" src="Public/css/bootstrap/js/bootstrap.min.js?2025"></script>
    <script type="text/javascript" src="Public/js/jquery-ui/jquery-ui-1.9.2-min.js?2025"></script>
    <script type="text/javascript" src="Public/js/jsPlumb/jquery.jsPlumb-1.3.16-all-min.js?2025"></script>
    <script type="text/javascript" src="Public/js/jquery.contextmenu.r2.js?2025"></script>
    <!--select 2-->
    <script type="text/javascript" src="Public/js/jquery.multiselect2side/js/jquery.multiselect2side.js?2025"></script>
    <!--flowdesign-->
    <script type="text/javascript" src="Public/js/flowdesign/leipi.flowdesign.v3.js?2025"></script>
    <script type="text/javascript" src="Public/js/flowdesign/attribute.js?2025"></script>
    <script type="text/javascript">
        var the_flow_id = '4';

        /*页面回调执行    callbackSuperDialog
        if(window.ActiveXObject){ //IE  
        window.returnValue = globalValue
        }else{ //非IE  
        if(window.opener) {  
        window.opener.callbackSuperDialog(globalValue) ;  
        }
        }  
        window.close();
        */
        function callbackSuperDialog(selectValue) {
            var aResult = selectValue.split('@leipi@');
            $('#' + window._viewField).val(aResult[0]);
            $('#' + window._hidField).val(aResult[1]);
            //document.getElementById(window._hidField).value = aResult[1];

        }
        /**
        * 弹出窗选择用户部门角色
        * showModalDialog 方式选择用户
        * URL 选择器地址
        * viewField 用来显示数据的ID
        * hidField 隐藏域数据ID
        * isOnly 是否只能选一条数据
        * dialogWidth * dialogHeight 弹出的窗口大小
        */
        function superDialog(URL, viewField, hidField, isOnly, dialogWidth, dialogHeight) {
            dialogWidth || (dialogWidth = 620)
    , dialogHeight || (dialogHeight = 520)
    , loc_x = 500
    , loc_y = 40
    , window._viewField = viewField
    , window._hidField = hidField;
            // loc_x = document.body.scrollLeft+event.clientX-event.offsetX;
            //loc_y = document.body.scrollTop+event.clientY-event.offsetY;
            if (window.ActiveXObject) { //IE  
                var selectValue = window.showModalDialog(URL, self, "edge:raised;scroll:1;status:0;help:0;resizable:1;dialogWidth:" + dialogWidth + "px;dialogHeight:" + dialogHeight + "px;dialogTop:" + loc_y + "px;dialogLeft:" + loc_x + "px");
                if (selectValue) {
                    callbackSuperDialog(selectValue);
                }
            } else {  //非IE 
                var selectValue = window.open(URL, 'newwindow', 'height=' + dialogHeight + ',width=' + dialogWidth + ',top=' + loc_y + ',left=' + loc_x + ',toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no');

            }
        }




        $(function () {
            var alertModal = $('#alertModal'), attributeModal = $("#attributeModal");
            //消息提示
            mAlert = function (messages, s) {
                if (!messages) messages = "";
                if (!s) s = 2000;
                alertModal.find(".modal-body").html(messages);
                alertModal.modal('toggle');
                setTimeout(function () { alertModal.modal("hide") }, s);
            }

            //属性设置
            attributeModal.on("hidden", function () {
                $(this).removeData("modal"); //移除数据，防止缓存
            });
            ajaxModal = function (url, fn) {
                url += url.indexOf('?') ? '&' : '?';
                url += '_t=' + new Date().getTime();
                //attributeModal.find(".modal-body").html('<img src="Public/images/loading.gif"/>');
                attributeModal.modal("show");

                //加载完成执行
                if (fn) {
                    attributeModal.on('shown', fn);
                }

            }
            //刷新页面
            function page_reload() {
                location.reload();
            }



            /*
            php 命名习惯 单词用下划线_隔开
            js 命名习惯：首字母小写 + 其它首字线大写
            */
            /*步骤数据*/
            var processData = { "total": 6, "list": [{ "id": "61", "flow_id": "4", "process_type": "start-activity", "process_name": "\u53d1\u8d77\u7533\u8bf7", "process_to": "63,64", "icon": "icon-ok", "style": "width:121px;height:41px;line-height:41px;color:#0e76a8;left:193px;top:132px;" }
            , { "id": "62", "flow_id": "4", "process_type": "activity", "process_name": "\u5ba1\u62792", "process_to": "65", "icon": "icon-star", "style": "width:120px;height:30px;line-height:30px;color:#0e76a8;left:486px;top:337px;" }
            , { "id": "63", "flow_id": "4", "process_type": "activity", "process_name": "\u5feb\u6377\u5ba1\u6279", "process_to": "65", "icon": "icon-star", "style": "width:120px;height:30px;line-height:30px;color:#0e76a8;left:193px;top:472px;" }
            , { "id": "64", "flow_id": "4", "process_type": "activity", "process_name": "\u5ba1\u62791", "process_to": "62,65", "icon": "icon-star", "style": "width:120px;height:30px;line-height:30px;color:#ff66b5;left:486px;top:137px;" }
            , { "id": "65", "flow_id": "4", "process_type": "activity", "process_name": "\u5f52\u6863\u6574\u7406\u4eba", "process_to": "66", "icon": "icon-star", "style": "width:120px;height:30px;line-height:30px;color:#0e76a8;left:738px;top:472px;" }
            , { "id": "66", "flow_id": "4", "process_type": "end-activity", "process_name": "完成", "process_to": "", "icon": "icon-stop", "style": "width:121px;height:41px;line-height:41px;color:#0e76a8;left:737px;top:603px;"}]
            };

            /*创建流程设计器*/
            var _canvas = $("#flowdesign_canvas").Flowdesign({
                "processData": processData
                /*,mtAfterDrop:function(params)
                {
                //alert("连接："+params.sourceId +" -> "+ params.targetId);
                }*/
                /*画面右键*/
                      , canvasMenus: {
                          "cmAdd": function (t) {
                              var mLeft = $("#jqContextMenu").css("left"), mTop = $("#jqContextMenu").css("top");

                              /*重要提示 start*/
                              //alert("这里使用ajax提交，请参考官网示例，可使用Fiddler软件抓包获取返回格式");
                              /*重要提示 end */

                              var url = "/index.php?s=/Flowdesign/add_process.html";
                              var data = {};
                              data.info = { flow_id: 86, icon: "", id: 311, process_name: "新建步骤", process_to: "", style: "left:" + mLeft + ";top:" + mTop + ";color:#0e76a8;" };
                              _canvas.addProcess(data.info);
                              /*$.post(url, { "flow_id": the_flow_id, "left": mLeft, "top": mTop }, function (data) {

                              if (!data.status) {
                              mAlert(data.msg);
                              } else if (!_canvas.addProcess(data.info))//添加
                              {
                              mAlert("添加失败");
                              }

                              }, 'json');*/

                          },
                          "cmSave": function (t) {
                              var processInfo = _canvas.getProcessInfo(); //连接信息

                              /*重要提示 start*/
                              alert("这里使用ajax提交，请参考官网示例，可使用Fiddler软件抓包获取返回格式");
                              /*重要提示 end */

                              var url = "/index.php?s=/Flowdesign/save_canvas.html";
                              $.post(url, { "flow_id": the_flow_id, "process_info": processInfo }, function (data) {
                                  mAlert(data.msg);
                              }, 'json');
                          },
                          //刷新
                          "cmRefresh": function (t) {
                              location.reload(); //_canvas.refresh();
                          },
                          /*"cmPaste": function(t) {
                          var pasteId = _canvas.paste();//右键当前的ID
                          if(pasteId<=0)
                          {
                          alert("你未复制任何步骤");
                          return ;
                          }
                          alert("粘贴:" + pasteId);
                          },*/
                          "cmHelp": function (t) {
                              mAlert('<ul><li><a href="http://flowdesign.leipi.org/doc.html" target="_blank">流程设计器 开发文档</a></li><li><a href="http://formdesign.leipi.org/doc.html" target="_blank">表单设计器 开发文档</a></li><li><a href="http://formdesign.leipi.org/demo.html" target="_blank">表单设计器 示例DEMO</a></li></ul>', 20000);
                          }

                      }
                /*步骤右键*/
                      , processMenus: {
                          /*
                          "pmBegin":function(t)
                          {
                          var activeId = _canvas.getActiveId();//右键当前的ID
                          alert("设为第一步:"+activeId);
                          },
                          "pmAddson":function(t)//添加子步骤
                          {
                          var activeId = _canvas.getActiveId();//右键当前的ID
                          },
                          "pmCopy":function(t)
                          {
                          //var activeId = _canvas.getActiveId();//右键当前的ID
                          _canvas.copy();//右键当前的ID
                          alert("复制成功");
                          },*/
                          "pmDelete": function (t) {
                              if (confirm("你确定删除步骤吗？")) {
                                  var activeId = _canvas.getActiveId(); //右键当前的ID

                                  /*重要提示 start*/
                                  alert("这里使用ajax提交，请参考官网示例，可使用Fiddler软件抓包获取返回格式");
                                  /*重要提示 end */

                                  var url = "/index.php?s=/Flowdesign/delete_process.html";
                                  $.post(url, { "flow_id": the_flow_id, "process_id": activeId }, function (data) {
                                      if (data.status == 1) {
                                          //清除步骤
                                          //_canvas.delProcess(activeId);
                                          //清除连接   暂时先保存设计 + 刷新 完成
                                          var processInfo = _canvas.getProcessInfo(); //连接信息
                                          var url = "/index.php?s=/Flowdesign/save_canvas.html";
                                          $.post(url, { "flow_id": the_flow_id, "process_info": processInfo }, function (data) {
                                              location.reload();
                                          }, 'json');

                                      }
                                      mAlert(data.msg);
                                  }, 'json');
                              }
                          },
                          "pmAttribute": function (t) {
                              var activeId = _canvas.getActiveId(); //右键当前的ID
                              /*重要提示 start*/
                              //alert("这里要使用程序处理，并非简单html页面，如果无法显示，请建立虚拟站点");
                              /*重要提示 end */
                              //var url = "/index.php?s=/Flowdesign/attribute/id/"+activeId+".html";
                              var url = '/Public/js/flowdesign/attribute.html?id=' + activeId;
                              ajaxModal(url, function () {
                                  //alert('加载完成执行')
                              });
                          },
                          "pmForm": function (t) {
                              var activeId = _canvas.getActiveId(); //右键当前的ID

                              /*重要提示 start*/
                              alert("这里使用ajax提交，请参考官网示例，可使用Fiddler软件抓包获取返回格式");
                              /*重要提示 end */

                              var url = "/index.php?s=/Flowdesign/attribute/op/form/id/" + activeId + ".html";
                              ajaxModal(url, function () {
                                  //alert('加载完成执行')
                              });
                          },
                          "pmJudge": function (t) {
                              var activeId = _canvas.getActiveId(); //右键当前的ID

                              /*重要提示 start*/
                              //alert("这里使用ajax提交，请参考官网示例，可使用Fiddler软件抓包获取返回格式");
                              /*重要提示 end */

                              var url = "/index.php?s=/Flowdesign/attribute/op/judge/id/" + activeId + ".html";
                              ajaxModal(url, function () {
                                  //alert('加载完成执行')
                              });
                          },
                          "pmSetting": function (t) {
                              var activeId = _canvas.getActiveId(); //右键当前的ID

                              /*重要提示 start*/
                              alert("这里要使用程序处理，并非简单html页面，如果无法显示，请建立虚拟站点");
                              /*重要提示 end */

                              //var url = "/index.php?s=/Flowdesign/attribute/op/style/id/"+activeId+".html";
                              var url = 'Public/js/flowdesign/attribute.html?id=' + activeId;
                              ajaxModal(url, function () {
                                  //alert('加载完成执行')
                              });
                          }
                      }
                      , fnRepeat: function () {
                          //alert("步骤连接重复1");//可使用 jquery ui 或其它方式提示
                          mAlert("步骤连接重复了，请重新连接");

                      }
                      , fnClick: function () {
                          var activeId = _canvas.getActiveId();
                          mAlert("查看步骤信息 " + activeId);
                      }
                      , fnDbClick: function () {
                          //和 pmAttribute 一样
                          var activeId = _canvas.getActiveId(); //右键当前的ID

                          /*重要提示 start*/
                          alert("这里使用ajax提交，请参考官网示例，可使用Fiddler软件抓包获取返回格式");
                          /*重要提示 end */

                          var url = "/index.php?s=/Flowdesign/attribute/id/" + activeId + ".html";
                          ajaxModal(url, function () {
                              //alert('加载完成执行')
                          });
                      }
            });




            /*保存*/
            $("#leipi_save").bind('click', function () {
                var processInfo = _canvas.getProcessInfo(); //连接信息

                /*重要提示 start*/
                alert("这里使用ajax提交，请参考官网示例，可使用Fiddler软件抓包获取返回格式");
                /*重要提示 end */


                var url = "/index.php?s=/Flowdesign/save_canvas.html";
                $.post(url, { "flow_id": the_flow_id, "process_info": processInfo }, function (data) {
                    mAlert(data.msg);
                }, 'json');
            });
            /*清除*/
            $("#leipi_clear").bind('click', function () {
                if (_canvas.clear()) {
                    //alert("清空连接成功");
                    mAlert("清空连接成功，你可以重新连接");
                } else {
                    //alert("清空连接失败");
                    mAlert("清空连接失败");
                }
            });



        });

 
    </script>
    <div style="display: none;">
        88888888888 88 ad88 88 ad88888ba 8888888888 88 "" d8" 88 d8" "88 88 88 88 88 8P
        88 88 ____ 88aaaaa 88 8b,dPPYba, ,adPPYba, MM88MMM 88 8b d8 Y8, ,d88 88a8PPPP8b,
        88""""" 88 88P' "Y8 a8P_____88 88 88 `8b d8' "PPPPPP"88 PP" `8b 88 88 88 8PP"""""""
        88 88 `8b d8' 8P d8 88 88 88 "8b, ,aa 88 88 `8b,d8' 8b, a8P Y8a a8P 88 88 88 `"Ybbd8"'
        88 88 Y88' `"Y8888P' "Y88888P" d8' 2014-3-15 Firefly95、xinG d8'
    </div>
    <div style="display: none">
        <script type="text/javascript">
            var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
            document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F1e6fd3a46a5046661159c6bf55aad1cf' type='text/javascript'%3E%3C/script%3E"));
        </script>
    </div>
</body>
</html>
